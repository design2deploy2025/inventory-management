# Task: Make Orders Table Dynamic (Connect to Supabase)

## Information Gathered:
- **Database Schema**: The `orders` table in Supabase has fields: id, user_id, order_number, customer_id, customer_name, customer_phone, customer_whatsapp, customer_instagram, total_price, order_status, payment_status, payment_type, notes, products (JSONB), source, invoice_date, due_date, created_at, updated_at
- **Current State**: MainTable.jsx uses hardcoded mock data (8 sample orders)
- **Existing Integration**: StatCards.jsx already fetches data from Supabase successfully
- **Auth Context**: User authentication is handled via AuthContext with Supabase

## Plan:

### 1. Modify MainTable.jsx
- Import `supabase` from `../lib/supabase` and `useAuth` from `../context/AuthContext`
- Replace hardcoded orders state with dynamic data from Supabase
- Add `useEffect` to fetch orders when user logs in
- Add state for loading and error handling
- Update `handleSaveOrder` to insert new order to Supabase
- Update `handleUpdateOrder` to update order in Supabase
- Add delete order functionality
- Add real-time subscription for order changes

### 2. Modify OrderModal.jsx
- Import `supabase` from `../lib/supabase` and `useAuth` from `../context/AuthContext`
- Replace hardcoded `sampleProducts` with dynamic products from Supabase
- Add customer selection from Supabase customers table
- Save orders to Supabase instead of local state

### 3. Update OrderModal to accept user from parent
- Pass user prop to OrderModal from MainTable
- Use user.id for filtering products and customers

## Followup Steps:
- Test the implementation by running the development server
- Verify orders are being saved to Supabase correctly
- Check real-time updates work properly

## Completed:
1. ✅ MainTable.jsx - Connected to Supabase for fetching, creating, updating orders
2. ✅ OrderModal.jsx - Fetches products and customers from Supabase dynamically
3. ✅ Added real-time subscription for live order updates
4. ✅ Added loading and error states to the orders table
5. ✅ Order numbers are auto-generated by Supabase database trigger

